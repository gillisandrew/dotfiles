. "$HOME/.local/bin/dotfiles-env"

# Homebrew shellenv
if [ "$DOTFILES_OS" = "macos" ]; then
  eval "$(/opt/homebrew/bin/brew shellenv)"
elif [ "$DDOTFILES_OS" = "linux" ]; then
  eval "$(/home/linuxbrew/.linuxbrew/bin/brew shellenv)"
fi

# Language/toolchain env
export GOPATH="$HOME/.local/share/go"
export GOBIN="$HOME/.local/bin"
export PATH="$PATH:$GOPATH/bin"

if [ "$DOTFILES_ENV" = "macos" ]; then
  export JAVA_HOME=$(/usr/libexec/java_home)
fi

# pnpm
if [ "$DOTFILES_OS" = "macos" ]; then
  export PNPM_HOME="$HOME/Library/pnpm"
else
  export PNPM_HOME="$HOME/.local/share/pnpm"
fi
case ":$PATH:" in
	*":$PNPM_HOME:"*) ;;
	*) export PATH="$PNPM_HOME:$PATH" ;;
esac

# uutils-coreutils (keg-only, provides modern GNU coreutils replacements)
if [ "$DOTFILES_OS" = "macos" ]; then
  [ -d "/opt/homebrew/opt/uutils-coreutils/libexec/uubin" ] && export PATH="/opt/homebrew/opt/uutils-coreutils/libexec/uubin:$PATH"
elif [ "$DOTFILES_OS" = "linux" ]; then
  [ -d "/home/linuxbrew/.linuxbrew/opt/uutils-coreutils/libexec/uubin" ] && export PATH="/home/linuxbrew/.linuxbrew/opt/uutils-coreutils/libexec/uubin:$PATH"
fi

# Rust (rustup is keg-only; cargo env adds ~/.cargo/bin)
if [ "$DOTFILES_OS" = "macos" ]; then
  [ -d "/opt/homebrew/opt/rustup/bin" ] && export PATH="/opt/homebrew/opt/rustup/bin:$PATH"
elif [ "$DOTFILES_OS" = "linux" ]; then
  [ -d "/home/linuxbrew/.linuxbrew/opt/rustup/bin" ] && export PATH="/home/linuxbrew/.linuxbrew/opt/rustup/bin:$PATH"
fi
[ -f "$HOME/.cargo/env" ] && . "$HOME/.cargo/env"

# Common user bins
[ -d "$HOME/.local/bin" ] && export PATH="$HOME/.local/bin:$PATH"

# Preferred editor for local and remote sessions
if [ -n "$SSH_CONNECTION" ]; then
	export EDITOR='vim'
else
	export EDITOR='code'
fi
