#!/bin/bash
# Symlink ~/.claude/skills → chezmoi source skills/ so edits are immediately live
set -euo pipefail

SOURCE_DIR="{{ .chezmoi.sourceDir }}/skills"
TARGET_DIR="{{ .chezmoi.homeDir }}/.claude/skills"

mkdir -p "$(dirname "$TARGET_DIR")"

# Remove existing directory/symlink if present
if [ -L "$TARGET_DIR" ]; then
    rm "$TARGET_DIR"
elif [ -d "$TARGET_DIR" ]; then
    rm -rf "$TARGET_DIR"
fi

ln -s "$SOURCE_DIR" "$TARGET_DIR"
echo "Linked $TARGET_DIR → $SOURCE_DIR"
