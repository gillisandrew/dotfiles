# core (always enabled)
{{ include "dot_Brewfile.d/core" -}}

{{- range glob (printf "%s/dot_Brewfile.d/*" .chezmoi.sourceDir) -}}
{{-   $group := base . -}}
{{-   if and (ne $group "core") (not (contains "." $group)) (has $group $.brew.groups) }}
# {{ $group }}
{{ include (printf "dot_Brewfile.d/%s" $group) -}}
{{   end -}}
{{- end -}}

{{- if has "vscode" $.brew.groups -}}
{{-   range glob (printf "%s/dot_Brewfile.d/*.vscode" .chezmoi.sourceDir) -}}
{{-     $group := trimSuffix ".vscode" (base .) -}}
{{-     if has $group $.brew.groups }}
# vscode ({{ $group }})
{{ include (printf "dot_Brewfile.d/%s.vscode" $group) -}}
{{     end -}}
{{-   end -}}
{{- end -}}
