## .zshrc: interactive shell config
# Runs for interactive shells only.
# Good: prompt/theme, aliases, functions, completions, keybindings.
# Avoid: PATH/toolchain exports (keep those in .zprofile).

[[ -o interactive ]] || return

. "$HOME/.local/bin/dotfiles-env"

autoload -Uz compinit
if [[ -f ~/.zcompdump && $(date +'%j') == $(stat -f '%Sm' -t '%j' ~/.zcompdump 2>/dev/null) ]]; then
  compinit -C  # use cached dump (skips security check + regeneration)
else
  compinit     # full rebuild
fi

if [ "$DOTFILES_OS" = "macos" ]; then
  _brew_prefix="/opt/homebrew"
elif [ "$DOTFILES_OS" = "linux" ]; then
  _brew_prefix="/home/linuxbrew/.linuxbrew"
fi
if [ -n "$_brew_prefix" ]; then
  [ -f "$_brew_prefix/share/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh" ] && source "$_brew_prefix/share/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh"
  [ -f "$_brew_prefix/share/zsh-autosuggestions/zsh-autosuggestions.zsh" ] && source "$_brew_prefix/share/zsh-autosuggestions/zsh-autosuggestions.zsh"
fi
unset _brew_prefix

{{ template "rc-common" "zsh" }}
