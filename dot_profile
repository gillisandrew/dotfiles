## .profile: login shell setup (bash/sh)
# Runs once for login shells. Put environment and PATH here.
# Good: PATH tweaks, JAVA_HOME, pnpm/go/cargo, EDITOR defaults.
# Avoid: prompt, aliases, completions, or interactive tooling.

. "$HOME/.local/bin/dotfiles-env"

# Homebrew shellenv
if [ "$DOTFILES_OS" = "macos" ]; then
  eval "$(/opt/homebrew/bin/brew shellenv)"
elif [ -x /home/linuxbrew/.linuxbrew/bin/brew ]; then
  eval "$(/home/linuxbrew/.linuxbrew/bin/brew shellenv)"
fi

# Language/toolchain env
export GOPATH="$HOME/.local/share/go"
export GOBIN="$HOME/.local/bin"
export PATH="$PATH:$GOPATH/bin"

if [ "$DOTFILES_ENV" = "macos" ]; then
  export JAVA_HOME=$(/usr/libexec/java_home)
fi

# pnpm
if [ "$DOTFILES_OS" = "macos" ]; then
  export PNPM_HOME="$HOME/Library/pnpm"
else
  export PNPM_HOME="$HOME/.local/share/pnpm"
fi
case ":$PATH:" in
	*":$PNPM_HOME:"*) ;;
	*) export PATH="$PNPM_HOME:$PATH" ;;
esac

# Cargo
[ -f "$HOME/.cargo/env" ] && . "$HOME/.cargo/env"

# Common user bins
[ -d "$HOME/.local/bin" ] && export PATH="$HOME/.local/bin:$PATH"

# Use XDG path for espanso config (macOS-only app, no .bashenv to put this in)
if [ "$DOTFILES_ENV" = "macos" ]; then
  export ESPANSO_CONFIG_DIR="$HOME/.config/espanso"
fi

# Preferred editor for local and remote sessions
if [ -n "$SSH_CONNECTION" ]; then
	export EDITOR='vim'
else
	export EDITOR='code'
fi
